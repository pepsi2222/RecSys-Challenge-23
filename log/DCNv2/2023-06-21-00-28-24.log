[2023-06-21 00:28:24] INFO Log saved in /root/autodl-tmp/yankai/Sharechat-RecSys-Challenge-23/RecStudio/log/DCNv2/install_with_weekday/2023-06-21-00-28-24.log.
[2023-06-21 00:28:24] INFO Global seed set to 2022
[2023-06-21 00:28:24] INFO Load dataset from cache.
[2023-06-21 00:28:32] INFO 
Dataset Info: 

======================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
interaction information: 
field        weekday      f_1          f_2          f_3          f_4          f_5          f_6          f_8          f_9          f_10         f_11         f_12         f_13         f_14         f_15         f_16         f_17         f_18         f_19         f_20         f_21         f_22         f_23         f_24         f_25         f_26         f_30         f_31         f_32         f_33         f_34         f_35         f_36         f_37         f_38         f_39         f_40         f_41         f_42         f_43         f_44         f_45         f_46         f_47         f_48         f_49         f_50         f_51         f_52         f_53         f_54         f_55         f_56         f_57         f_58         f_59         f_60         f_61         f_62         f_63         f_64         f_65         f_66         f_67         f_68         f_69         f_70         f_71         f_72         f_73         f_74         f_75         f_76         f_77         f_78         f_79         is_installed 
type         token        float        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        float        token        token        token        token        token        token        token        token        token        token        token        token        token        token        float        float        token        token        token        token        float        float        float        float        float        float        float        token        token        token        token        token        token        token        token        token        float        
##           8            -            140          6            639          7            5235         7            8            4            25           27           332          20           5855         13           50           925          20           58           36           27           5            5            4            3            3            3            5            3            3            3            3            3            3            3            3            3            8883         -            22           24           12           28           28           21           35           1829         172          103          213          390          221          517          -            -            403          826          1397         408          -            -            -            -            -            -            -            5            12           9            5            32           9            5            14           8            -            
======================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
Total Interactions: 3646825
======================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
f_1=StandardScaler()
f_43=StandardScaler()
f_58=StandardScaler()
f_59=StandardScaler()
f_64=MinMaxScaler()
f_65=StandardScaler()
f_66=StandardScaler()
f_67=StandardScaler()
f_68=StandardScaler()
f_69=StandardScaler()
f_70=StandardScaler()
[2023-06-21 00:28:32] INFO 
Model Config: 

data:
	binarized_rating_thres=None
	fm_eval=False
	neg_count=0
	sampler=None
	shuffle=False
	split_mode=entry
	split_ratio=[3387880, 97972, 160973]
	fmeval=True
	low_rating_thres=None
eval:
	batch_size=4096
	cutoff=[5, 10, 20]
	val_metrics=['logloss', 'auc', 'accuracy', 'f1', 'precision', 'recall']
	val_n_epoch=1
	test_metrics=['logloss', 'auc', 'accuracy', 'f1', 'precision', 'recall']
	topk=100
	save_path=./saved/
	binarized_prob_thres=0.5
model:
	embed_dim=70
	item_bias=False
	combination=stacked
	low_rank=None
	num_experts=3
	num_layers=4
	mlp_layer=[256, 256, 256]
	activation=relu
	cross_activation=tanh
	dropout=0.1
	batch_norm=True
train:
	accelerator=gpu
	ann=None
	batch_size=2048
	early_stop_mode=min
	early_stop_patience=10
	epochs=1000
	gpu=[1]
	grad_clip_norm=None
	init_method=xavier_normal
	item_batch_size=1024
	learner=adam
	learning_rate=0.001
	num_threads=10
	sampling_method=none
	sampler=uniform
	negative_count=0
	excluding_hist=False
	scheduler=exponential
	seed=2022
	weight_decay=3e-05
	tensorboard_path=None
[2023-06-21 00:28:34] INFO save_dir:./saved/
[2023-06-21 00:28:34] INFO DCNv2(
  (loss_fn): BCEWithLogitLoss()
  (embedding): Embeddings(
    num_features=76, embed_dim=70, reduction=mean
    (embeddings): ModuleDict(
      (f_68): DenseEmbedding(
        embedding_dim=70, bias=False, batch_norm=True
        (batch_norm_layer): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (weight): Linear(in_features=1, out_features=70, bias=False)
      )
      (f_38): Embedding(3, 70, padding_idx=0)
      (f_43): DenseEmbedding(
        embedding_dim=70, bias=False, batch_norm=True
        (batch_norm_layer): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (weight): Linear(in_features=1, out_features=70, bias=False)
      )
      (f_35): Embedding(3, 70, padding_idx=0)
      (f_23): Embedding(5, 70, padding_idx=0)
      (f_42): Embedding(8883, 70, padding_idx=0)
      (f_5): Embedding(7, 70, padding_idx=0)
      (f_71): Embedding(5, 70, padding_idx=0)
      (f_3): Embedding(6, 70, padding_idx=0)
      (f_79): Embedding(8, 70, padding_idx=0)
      (f_65): DenseEmbedding(
        embedding_dim=70, bias=False, batch_norm=True
        (batch_norm_layer): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (weight): Linear(in_features=1, out_features=70, bias=False)
      )
      (f_49): Embedding(21, 70, padding_idx=0)
      (f_25): Embedding(4, 70, padding_idx=0)
      (f_34): Embedding(3, 70, padding_idx=0)
      (f_50): Embedding(35, 70, padding_idx=0)
      (f_6): Embedding(5235, 70, padding_idx=0)
      (f_66): DenseEmbedding(
        embedding_dim=70, bias=False, batch_norm=True
        (batch_norm_layer): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (weight): Linear(in_features=1, out_features=70, bias=False)
      )
      (f_15): Embedding(5855, 70, padding_idx=0)
      (f_56): Embedding(221, 70, padding_idx=0)
      (f_51): Embedding(1829, 70, padding_idx=0)
      (f_73): Embedding(9, 70, padding_idx=0)
      (f_8): Embedding(7, 70, padding_idx=0)
      (f_36): Embedding(3, 70, padding_idx=0)
      (f_52): Embedding(172, 70, padding_idx=0)
      (f_30): Embedding(3, 70, padding_idx=0)
      (f_12): Embedding(27, 70, padding_idx=0)
      (f_26): Embedding(3, 70, padding_idx=0)
      (f_19): Embedding(20, 70, padding_idx=0)
      (f_59): DenseEmbedding(
        embedding_dim=70, bias=False, batch_norm=True
        (batch_norm_layer): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (weight): Linear(in_features=1, out_features=70, bias=False)
      )
      (f_69): DenseEmbedding(
        embedding_dim=70, bias=False, batch_norm=True
        (batch_norm_layer): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (weight): Linear(in_features=1, out_features=70, bias=False)
      )
      (f_17): Embedding(50, 70, padding_idx=0)
      (f_74): Embedding(5, 70, padding_idx=0)
      (f_33): Embedding(3, 70, padding_idx=0)
      (f_10): Embedding(4, 70, padding_idx=0)
      (f_67): DenseEmbedding(
        embedding_dim=70, bias=False, batch_norm=True
        (batch_norm_layer): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (weight): Linear(in_features=1, out_features=70, bias=False)
      )
      (f_75): Embedding(32, 70, padding_idx=0)
      (f_11): Embedding(25, 70, padding_idx=0)
      (f_21): Embedding(36, 70, padding_idx=0)
      (f_20): Embedding(58, 70, padding_idx=0)
      (f_40): Embedding(3, 70, padding_idx=0)
      (weekday): Embedding(8, 70, padding_idx=0)
      (f_14): Embedding(20, 70, padding_idx=0)
      (f_39): Embedding(3, 70, padding_idx=0)
      (f_60): Embedding(403, 70, padding_idx=0)
      (f_48): Embedding(28, 70, padding_idx=0)
      (f_57): Embedding(517, 70, padding_idx=0)
      (f_70): DenseEmbedding(
        embedding_dim=70, bias=False, batch_norm=True
        (batch_norm_layer): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (weight): Linear(in_features=1, out_features=70, bias=False)
      )
      (f_45): Embedding(24, 70, padding_idx=0)
      (f_32): Embedding(5, 70, padding_idx=0)
      (f_47): Embedding(28, 70, padding_idx=0)
      (f_53): Embedding(103, 70, padding_idx=0)
      (f_76): Embedding(9, 70, padding_idx=0)
      (f_41): Embedding(3, 70, padding_idx=0)
      (f_63): Embedding(408, 70, padding_idx=0)
      (f_13): Embedding(332, 70, padding_idx=0)
      (f_2): Embedding(140, 70, padding_idx=0)
      (f_37): Embedding(3, 70, padding_idx=0)
      (f_46): Embedding(12, 70, padding_idx=0)
      (f_16): Embedding(13, 70, padding_idx=0)
      (f_24): Embedding(5, 70, padding_idx=0)
      (f_44): Embedding(22, 70, padding_idx=0)
      (f_77): Embedding(5, 70, padding_idx=0)
      (f_9): Embedding(8, 70, padding_idx=0)
      (f_64): DenseEmbedding(
        embedding_dim=70, bias=False, batch_norm=True
        (batch_norm_layer): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (weight): Linear(in_features=1, out_features=70, bias=False)
      )
      (f_18): Embedding(925, 70, padding_idx=0)
      (f_55): Embedding(390, 70, padding_idx=0)
      (f_54): Embedding(213, 70, padding_idx=0)
      (f_72): Embedding(12, 70, padding_idx=0)
      (f_1): DenseEmbedding(
        embedding_dim=70, bias=False, batch_norm=True
        (batch_norm_layer): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (weight): Linear(in_features=1, out_features=70, bias=False)
      )
      (f_58): DenseEmbedding(
        embedding_dim=70, bias=False, batch_norm=True
        (batch_norm_layer): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (weight): Linear(in_features=1, out_features=70, bias=False)
      )
      (f_4): Embedding(639, 70, padding_idx=0)
      (f_61): Embedding(826, 70, padding_idx=0)
      (f_78): Embedding(14, 70, padding_idx=0)
      (f_22): Embedding(27, 70, padding_idx=0)
      (f_31): Embedding(3, 70, padding_idx=0)
      (f_62): Embedding(1397, 70, padding_idx=0)
    )
  )
  (cross_net): CrossNetworkV2(
    embed_dim=5320, num_layers=4
    (linear): ModuleList(
      (0-3): 4 x Linear(in_features=5320, out_features=5320, bias=True)
    )
  )
  (mlp): MLPModule(
    (model): Sequential(
      (0): Dropout(p=0.1, inplace=False)
      (1): Linear(in_features=5320, out_features=256, bias=True)
      (2): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (3): ReLU()
      (4): Dropout(p=0.1, inplace=False)
      (5): Linear(in_features=256, out_features=256, bias=True)
      (6): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (7): ReLU()
      (8): Dropout(p=0.1, inplace=False)
      (9): Linear(in_features=256, out_features=256, bias=True)
      (10): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (11): ReLU()
      (12): Dropout(p=0.1, inplace=False)
      (13): Linear(in_features=256, out_features=1, bias=True)
    )
  )
)
[2023-06-21 00:28:34] INFO GPU id [1] are selected.
[2023-06-21 00:38:47] INFO Training: Epoch=  0 [logloss=0.3877 accuracy=0.8240 f1=0.2512 precision=0.6200 recall=0.1576 auc=0.8199 train_loss_0=0.2694]
[2023-06-21 00:38:48] INFO Train time: 602.82505s. Valid time: 7.91817s. GPU RAM: 3.61/39.39 GB
[2023-06-21 00:38:48] INFO logloss improved. Best value: 0.3877
[2023-06-21 00:48:25] INFO Training: Epoch=  1 [logloss=0.4003 accuracy=0.8241 f1=0.2127 precision=0.6589 recall=0.1269 auc=0.8181 train_loss_0=0.2571]
[2023-06-21 00:48:25] INFO Train time: 570.20750s. Valid time: 6.92020s. GPU RAM: 4.04/39.39 GB
[2023-06-21 00:57:46] INFO Training: Epoch=  2 [logloss=0.3745 accuracy=0.8270 f1=0.2954 precision=0.6241 recall=0.1936 auc=0.8297 train_loss_0=0.2547]
[2023-06-21 00:57:46] INFO Train time: 553.52351s. Valid time: 7.24411s. GPU RAM: 4.04/39.39 GB
[2023-06-21 00:57:46] INFO logloss improved. Best value: 0.3745
[2023-06-21 01:07:43] INFO Training: Epoch=  3 [logloss=0.3779 accuracy=0.8279 f1=0.2647 precision=0.6640 recall=0.1653 auc=0.8345 train_loss_0=0.2534]
[2023-06-21 01:07:43] INFO Train time: 590.73415s. Valid time: 7.02087s. GPU RAM: 4.04/39.39 GB
[2023-06-21 01:17:02] INFO Training: Epoch=  4 [logloss=0.3750 accuracy=0.8277 f1=0.2816 precision=0.6440 recall=0.1803 auc=0.8292 train_loss_0=0.2524]
[2023-06-21 01:17:02] INFO Train time: 551.64680s. Valid time: 6.81403s. GPU RAM: 4.04/39.39 GB
[2023-06-21 01:26:41] INFO Training: Epoch=  5 [logloss=0.3751 accuracy=0.8279 f1=0.2587 precision=0.6711 recall=0.1603 auc=0.8359 train_loss_0=0.2516]
[2023-06-21 01:26:41] INFO Train time: 572.33929s. Valid time: 7.04084s. GPU RAM: 4.04/39.39 GB
[2023-06-21 01:37:01] INFO Training: Epoch=  6 [logloss=0.3726 accuracy=0.8262 f1=0.3639 precision=0.5792 recall=0.2654 auc=0.8245 train_loss_0=0.2510]
[2023-06-21 01:37:01] INFO Train time: 612.68980s. Valid time: 7.34979s. GPU RAM: 4.04/39.39 GB
[2023-06-21 01:37:01] INFO logloss improved. Best value: 0.3726
[2023-06-21 01:47:08] INFO Training: Epoch=  7 [logloss=0.3839 accuracy=0.8252 f1=0.2986 precision=0.6020 recall=0.1986 auc=0.8251 train_loss_0=0.2505]
[2023-06-21 01:47:08] INFO Train time: 599.60689s. Valid time: 7.21434s. GPU RAM: 4.04/39.39 GB
[2023-06-21 01:56:58] INFO Training: Epoch=  8 [logloss=0.3688 accuracy=0.8267 f1=0.2836 precision=0.6295 recall=0.1831 auc=0.8351 train_loss_0=0.2501]
[2023-06-21 01:56:58] INFO Train time: 581.57835s. Valid time: 7.63861s. GPU RAM: 4.04/39.39 GB
[2023-06-21 01:56:58] INFO logloss improved. Best value: 0.3688
[2023-06-21 02:06:47] INFO Training: Epoch=  9 [logloss=0.3804 accuracy=0.8244 f1=0.3003 precision=0.5931 recall=0.2012 auc=0.8280 train_loss_0=0.2498]
[2023-06-21 02:06:47] INFO Train time: 581.93373s. Valid time: 7.43735s. GPU RAM: 4.04/39.39 GB
[2023-06-21 02:16:31] INFO Training: Epoch= 10 [logloss=0.3814 accuracy=0.8231 f1=0.3219 precision=0.5716 recall=0.2241 auc=0.8191 train_loss_0=0.2496]
[2023-06-21 02:16:31] INFO Train time: 577.51985s. Valid time: 6.81238s. GPU RAM: 4.04/39.39 GB
[2023-06-21 02:26:55] INFO Training: Epoch= 11 [logloss=0.3813 accuracy=0.8162 f1=0.3697 precision=0.5174 recall=0.2877 auc=0.8209 train_loss_0=0.2493]
[2023-06-21 02:26:55] INFO Train time: 615.72305s. Valid time: 7.34669s. GPU RAM: 4.04/39.39 GB
[2023-06-21 02:37:49] INFO Training: Epoch= 12 [logloss=0.3747 accuracy=0.8233 f1=0.2974 precision=0.5839 recall=0.1996 auc=0.8278 train_loss_0=0.2492]
[2023-06-21 02:37:49] INFO Train time: 647.33455s. Valid time: 7.31697s. GPU RAM: 4.04/39.39 GB
[2023-06-21 02:47:41] INFO Training: Epoch= 13 [logloss=0.3758 accuracy=0.8277 f1=0.3400 precision=0.6030 recall=0.2369 auc=0.8271 train_loss_0=0.2490]
[2023-06-21 02:47:41] INFO Train time: 584.15061s. Valid time: 7.37273s. GPU RAM: 4.04/39.39 GB
[2023-06-21 02:57:28] INFO Training: Epoch= 14 [logloss=0.3828 accuracy=0.8203 f1=0.3107 precision=0.5531 recall=0.2162 auc=0.8232 train_loss_0=0.2488]
[2023-06-21 02:57:28] INFO Train time: 579.83937s. Valid time: 7.48804s. GPU RAM: 4.04/39.39 GB
[2023-06-21 03:03:49] INFO Training: Epoch= 15 [logloss=0.3847 accuracy=0.8139 f1=0.3212 precision=0.5075 recall=0.2351 auc=0.8174 train_loss_0=0.2487]
[2023-06-21 03:03:49] INFO Train time: 373.20836s. Valid time: 6.87173s. GPU RAM: 4.04/39.39 GB
[2023-06-21 03:14:00] INFO Training: Epoch= 16 [logloss=0.3858 accuracy=0.8191 f1=0.2997 precision=0.5462 recall=0.2067 auc=0.8153 train_loss_0=0.2485]
[2023-06-21 03:14:00] INFO Train time: 603.70864s. Valid time: 7.44167s. GPU RAM: 4.04/39.39 GB
[2023-06-21 03:24:08] INFO Training: Epoch= 17 [logloss=0.3864 accuracy=0.8174 f1=0.3205 precision=0.5295 recall=0.2300 auc=0.8172 train_loss_0=0.2484]
[2023-06-21 03:24:08] INFO Train time: 600.72778s. Valid time: 7.12816s. GPU RAM: 4.04/39.39 GB
[2023-06-21 03:34:36] INFO Training: Epoch= 18 [logloss=0.3866 accuracy=0.8136 f1=0.3501 precision=0.5052 recall=0.2680 auc=0.8102 train_loss_0=0.2484]
[2023-06-21 03:34:37] INFO Train time: 620.83786s. Valid time: 7.70017s. GPU RAM: 4.04/39.39 GB
[2023-06-21 03:34:37] INFO Early stopped. Since the metric logloss haven't been improved for 10 epochs.
[2023-06-21 03:34:37] INFO The best score of logloss is 0.3688 on epoch 8
[2023-06-21 03:34:38] INFO Best model checkpoint saved in ./saved/DCNv2/install_with_weekday/2023-06-21-00-28-24.ckpt.
[2023-06-21 03:36:54] INFO Predictions saved in ./predictions/DCNv2/2023-06-21-03-34-38is_installed.csv
