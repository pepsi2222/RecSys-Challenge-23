[2023-06-17 21:05:34] INFO Log saved in /data2/home/xingmei/RecSys23/log/MMoE/recsys/2023-06-17-21-05-34.log.
[2023-06-17 21:05:34] INFO Global seed set to 2022
[2023-06-17 21:05:34] INFO Load dataset from cache.
[2023-06-17 21:05:36] INFO 
Dataset Info: 

======================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
interaction information: 
field        f_1          f_2          f_3          f_4          f_5          f_6          f_8          f_9          f_10         f_11         f_12         f_13         f_14         f_15         f_16         f_17         f_18         f_19         f_20         f_21         f_22         f_23         f_24         f_25         f_26         f_30         f_31         f_32         f_33         f_34         f_35         f_36         f_37         f_38         f_39         f_40         f_41         f_42         f_43         f_44         f_45         f_46         f_47         f_48         f_49         f_50         f_51         f_52         f_53         f_54         f_55         f_56         f_57         f_58         f_59         f_60         f_61         f_62         f_63         f_64         f_65         f_66         f_67         f_68         f_69         f_70         f_71         f_72         f_73         f_74         f_75         f_76         f_77         f_78         f_79         is_clicked   is_installed 
type         float        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        token        float        token        token        token        token        token        token        token        token        token        token        token        token        token        token        float        float        token        token        token        token        float        float        float        float        float        float        float        token        token        token        token        token        token        token        token        token        float        float        
##           -            140          6            639          7            5235         7            8            4            25           27           332          20           5855         13           50           925          20           58           36           27           5            5            4            3            3            3            5            3            3            3            3            3            3            3            3            3            8883         -            22           24           12           28           28           21           35           1829         172          103          213          390          221          517          -            -            403          826          1397         408          -            -            -            -            -            -            -            5            12           9            5            32           9            5            14           8            -            -            
======================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
Total Interactions: 3646825
======================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
f_1=StandardScaler()
f_43=StandardScaler()
f_58=StandardScaler()
f_59=StandardScaler()
f_64=MinMaxScaler()
f_65=StandardScaler()
f_66=StandardScaler()
f_67=StandardScaler()
f_68=StandardScaler()
f_69=StandardScaler()
f_70=StandardScaler()
[2023-06-17 21:05:36] INFO 
Model Config: 

data:
	binarized_rating_thres=None
	fm_eval=False
	neg_count=0
	sampler=None
	shuffle=False
	split_mode=entry
	split_ratio=[3387880, 97972, 160973]
	fmeval=True
	low_rating_thres=None
eval:
	batch_size=4096
	cutoff=[5, 10, 20]
	val_metrics=['logloss', 'auc', 'accuracy', 'f1', 'precision', 'recall']
	val_n_epoch=1
	test_metrics=['logloss', 'auc', 'accuracy', 'f1', 'precision', 'recall']
	topk=100
	save_path=./saved/
	binarized_prob_thres=0.5
	main_task=is_installed
model:
	embed_dim=64
	item_bias=False
	num_experts=4
	expert_mlp_layer=[128, 128]
	expert_activation=relu
	expert_dropout=0.1
	expert_batch_norm=False
	gate_mlp_layer=[128]
	gate_activation=relu
	gate_dropout=0.1
	gate_batch_norm=False
	tower_mlp_layer=[128]
	tower_activation=relu
	tower_dropout=0.1
	tower_batch_norm=False
train:
	accelerator=gpu
	ann=None
	batch_size=512
	early_stop_mode=min
	early_stop_patience=10
	epochs=1000
	gpu=[0]
	grad_clip_norm=None
	init_method=xavier_normal
	item_batch_size=1024
	learner=adam
	learning_rate=0.001
	num_threads=10
	sampling_method=none
	sampler=uniform
	negative_count=0
	excluding_hist=False
	scheduler=None
	seed=2022
	weight_decay=1e-05
	tensorboard_path=None
	weights=None
[2023-06-17 21:05:36] INFO save_dir:./saved/
[2023-06-17 21:05:36] INFO MMoE(
  (loss_fn): BCEWithLogitLoss()
  (embedding): Embeddings(
    num_features=75, embed_dim=64, reduction=mean
    (embeddings): ModuleDict(
      (f_32): Embedding(5, 64, padding_idx=0)
      (f_21): Embedding(36, 64, padding_idx=0)
      (f_52): Embedding(172, 64, padding_idx=0)
      (f_45): Embedding(24, 64, padding_idx=0)
      (f_49): Embedding(21, 64, padding_idx=0)
      (f_62): Embedding(1397, 64, padding_idx=0)
      (f_70): DenseEmbedding(
        embedding_dim=64, bias=False, batch_norm=True
        (batch_norm_layer): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (weight): Linear(in_features=1, out_features=64, bias=False)
      )
      (f_43): DenseEmbedding(
        embedding_dim=64, bias=False, batch_norm=True
        (batch_norm_layer): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (weight): Linear(in_features=1, out_features=64, bias=False)
      )
      (f_53): Embedding(103, 64, padding_idx=0)
      (f_24): Embedding(5, 64, padding_idx=0)
      (f_23): Embedding(5, 64, padding_idx=0)
      (f_4): Embedding(639, 64, padding_idx=0)
      (f_26): Embedding(3, 64, padding_idx=0)
      (f_44): Embedding(22, 64, padding_idx=0)
      (f_10): Embedding(4, 64, padding_idx=0)
      (f_1): DenseEmbedding(
        embedding_dim=64, bias=False, batch_norm=True
        (batch_norm_layer): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (weight): Linear(in_features=1, out_features=64, bias=False)
      )
      (f_19): Embedding(20, 64, padding_idx=0)
      (f_65): DenseEmbedding(
        embedding_dim=64, bias=False, batch_norm=True
        (batch_norm_layer): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (weight): Linear(in_features=1, out_features=64, bias=False)
      )
      (f_38): Embedding(3, 64, padding_idx=0)
      (f_61): Embedding(826, 64, padding_idx=0)
      (f_34): Embedding(3, 64, padding_idx=0)
      (f_9): Embedding(8, 64, padding_idx=0)
      (f_51): Embedding(1829, 64, padding_idx=0)
      (f_56): Embedding(221, 64, padding_idx=0)
      (f_5): Embedding(7, 64, padding_idx=0)
      (f_33): Embedding(3, 64, padding_idx=0)
      (f_36): Embedding(3, 64, padding_idx=0)
      (f_57): Embedding(517, 64, padding_idx=0)
      (f_60): Embedding(403, 64, padding_idx=0)
      (f_67): DenseEmbedding(
        embedding_dim=64, bias=False, batch_norm=True
        (batch_norm_layer): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (weight): Linear(in_features=1, out_features=64, bias=False)
      )
      (f_79): Embedding(8, 64, padding_idx=0)
      (f_31): Embedding(3, 64, padding_idx=0)
      (f_12): Embedding(27, 64, padding_idx=0)
      (f_35): Embedding(3, 64, padding_idx=0)
      (f_71): Embedding(5, 64, padding_idx=0)
      (f_47): Embedding(28, 64, padding_idx=0)
      (f_16): Embedding(13, 64, padding_idx=0)
      (f_20): Embedding(58, 64, padding_idx=0)
      (f_25): Embedding(4, 64, padding_idx=0)
      (f_37): Embedding(3, 64, padding_idx=0)
      (f_72): Embedding(12, 64, padding_idx=0)
      (f_8): Embedding(7, 64, padding_idx=0)
      (f_66): DenseEmbedding(
        embedding_dim=64, bias=False, batch_norm=True
        (batch_norm_layer): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (weight): Linear(in_features=1, out_features=64, bias=False)
      )
      (f_69): DenseEmbedding(
        embedding_dim=64, bias=False, batch_norm=True
        (batch_norm_layer): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (weight): Linear(in_features=1, out_features=64, bias=False)
      )
      (f_3): Embedding(6, 64, padding_idx=0)
      (f_76): Embedding(9, 64, padding_idx=0)
      (f_63): Embedding(408, 64, padding_idx=0)
      (f_58): DenseEmbedding(
        embedding_dim=64, bias=False, batch_norm=True
        (batch_norm_layer): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (weight): Linear(in_features=1, out_features=64, bias=False)
      )
      (f_6): Embedding(5235, 64, padding_idx=0)
      (f_30): Embedding(3, 64, padding_idx=0)
      (f_68): DenseEmbedding(
        embedding_dim=64, bias=False, batch_norm=True
        (batch_norm_layer): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (weight): Linear(in_features=1, out_features=64, bias=False)
      )
      (f_64): DenseEmbedding(
        embedding_dim=64, bias=False, batch_norm=True
        (batch_norm_layer): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (weight): Linear(in_features=1, out_features=64, bias=False)
      )
      (f_77): Embedding(5, 64, padding_idx=0)
      (f_13): Embedding(332, 64, padding_idx=0)
      (f_40): Embedding(3, 64, padding_idx=0)
      (f_2): Embedding(140, 64, padding_idx=0)
      (f_74): Embedding(5, 64, padding_idx=0)
      (f_14): Embedding(20, 64, padding_idx=0)
      (f_50): Embedding(35, 64, padding_idx=0)
      (f_42): Embedding(8883, 64, padding_idx=0)
      (f_11): Embedding(25, 64, padding_idx=0)
      (f_78): Embedding(14, 64, padding_idx=0)
      (f_22): Embedding(27, 64, padding_idx=0)
      (f_48): Embedding(28, 64, padding_idx=0)
      (f_18): Embedding(925, 64, padding_idx=0)
      (f_15): Embedding(5855, 64, padding_idx=0)
      (f_39): Embedding(3, 64, padding_idx=0)
      (f_55): Embedding(390, 64, padding_idx=0)
      (f_59): DenseEmbedding(
        embedding_dim=64, bias=False, batch_norm=True
        (batch_norm_layer): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (weight): Linear(in_features=1, out_features=64, bias=False)
      )
      (f_54): Embedding(213, 64, padding_idx=0)
      (f_46): Embedding(12, 64, padding_idx=0)
      (f_17): Embedding(50, 64, padding_idx=0)
      (f_75): Embedding(32, 64, padding_idx=0)
      (f_41): Embedding(3, 64, padding_idx=0)
      (f_73): Embedding(9, 64, padding_idx=0)
    )
  )
  (experts): ModuleList(
    (0-3): 4 x MLPModule(
      (model): Sequential(
        (0): Dropout(p=0.1, inplace=False)
        (1): Linear(in_features=4800, out_features=128, bias=True)
        (2): ReLU()
        (3): Dropout(p=0.1, inplace=False)
        (4): Linear(in_features=128, out_features=128, bias=True)
        (5): ReLU()
      )
    )
  )
  (gates): ModuleDict(
    (is_clicked): MLPModule(
      (model): Sequential(
        (0): Dropout(p=0.1, inplace=False)
        (1): Linear(in_features=4800, out_features=128, bias=True)
        (2): ReLU()
        (3): Dropout(p=0.1, inplace=False)
        (4): Linear(in_features=128, out_features=4, bias=True)
        (5): ReLU()
        (6): Softmax(dim=-1)
      )
    )
    (is_installed): MLPModule(
      (model): Sequential(
        (0): Dropout(p=0.1, inplace=False)
        (1): Linear(in_features=4800, out_features=128, bias=True)
        (2): ReLU()
        (3): Dropout(p=0.1, inplace=False)
        (4): Linear(in_features=128, out_features=4, bias=True)
        (5): ReLU()
        (6): Softmax(dim=-1)
      )
    )
  )
  (towers): ModuleDict(
    (is_clicked): MLPModule(
      (model): Sequential(
        (0): Dropout(p=0.1, inplace=False)
        (1): Linear(in_features=128, out_features=128, bias=True)
        (2): ReLU()
        (3): Dropout(p=0.1, inplace=False)
        (4): Linear(in_features=128, out_features=1, bias=True)
      )
    )
    (is_installed): MLPModule(
      (model): Sequential(
        (0): Dropout(p=0.1, inplace=False)
        (1): Linear(in_features=128, out_features=128, bias=True)
        (2): ReLU()
        (3): Dropout(p=0.1, inplace=False)
        (4): Linear(in_features=128, out_features=1, bias=True)
      )
    )
  )
)
[2023-06-17 21:05:36] INFO GPU id [0] are selected.
[2023-06-17 21:08:44] INFO Training: Epoch=  0 [train_loss_0=0.2766 is_clicked logloss=0.4872 accuracy=0.7924 f1=0.6409 precision=0.8590 recall=0.5111 auc=0.7822 train_loss_0=0.2822 is_installed logloss=0.4017 accuracy=0.8211 f1=0.1886 precision=0.6297 recall=0.1110 auc=0.8068 train_loss_0=0.2710]
[2023-06-17 21:08:44] INFO Train time: 186.40104s. Valid time: 0.42439s. GPU RAM: 0.35/10.76 GB
[2023-06-17 21:08:44] INFO logloss improved. Best value: 0.4017
[2023-06-17 21:11:49] INFO Training: Epoch=  1 [train_loss_0=0.2644 is_clicked logloss=0.4909 accuracy=0.7865 f1=0.6409 precision=0.8208 recall=0.5258 auc=0.7902 train_loss_0=0.2689 is_installed logloss=0.3982 accuracy=0.8208 f1=0.1970 precision=0.6154 recall=0.1173 auc=0.8004 train_loss_0=0.2599]
[2023-06-17 21:11:49] INFO Train time: 184.68127s. Valid time: 0.51798s. GPU RAM: 0.36/10.76 GB
[2023-06-17 21:11:50] INFO logloss improved. Best value: 0.3982
[2023-06-17 21:14:55] INFO Training: Epoch=  2 [train_loss_0=0.2621 is_clicked logloss=0.5436 accuracy=0.7554 f1=0.6161 precision=0.7144 recall=0.5416 auc=0.7712 train_loss_0=0.2663 is_installed logloss=0.4060 accuracy=0.8152 f1=0.2686 precision=0.5205 recall=0.1812 auc=0.7951 train_loss_0=0.2579]
[2023-06-17 21:14:55] INFO Train time: 184.22002s. Valid time: 0.47135s. GPU RAM: 0.36/10.76 GB
[2023-06-17 21:18:02] INFO Training: Epoch=  3 [train_loss_0=0.2611 is_clicked logloss=0.5529 accuracy=0.7339 f1=0.6019 precision=0.6573 recall=0.5553 auc=0.7731 train_loss_0=0.2654 is_installed logloss=0.4021 accuracy=0.8092 f1=0.2713 precision=0.4776 recall=0.1896 auc=0.7984 train_loss_0=0.2568]
[2023-06-17 21:18:02] INFO Train time: 186.27406s. Valid time: 0.42855s. GPU RAM: 0.36/10.76 GB
[2023-06-17 21:21:08] INFO Training: Epoch=  4 [train_loss_0=0.2605 is_clicked logloss=0.5219 accuracy=0.7661 f1=0.6354 precision=0.7306 recall=0.5622 auc=0.7850 train_loss_0=0.2648 is_installed logloss=0.3958 accuracy=0.8179 f1=0.2557 precision=0.5470 recall=0.1670 auc=0.8018 train_loss_0=0.2563]
[2023-06-17 21:21:08] INFO Train time: 185.43998s. Valid time: 0.40963s. GPU RAM: 0.36/10.76 GB
[2023-06-17 21:21:08] INFO logloss improved. Best value: 0.3958
[2023-06-17 21:24:16] INFO Training: Epoch=  5 [train_loss_0=0.2601 is_clicked logloss=0.5743 accuracy=0.7366 f1=0.6105 precision=0.6578 recall=0.5697 auc=0.7780 train_loss_0=0.2644 is_installed logloss=0.4087 accuracy=0.8135 f1=0.2463 precision=0.5083 recall=0.1626 auc=0.7918 train_loss_0=0.2558]
[2023-06-17 21:24:16] INFO Train time: 186.71719s. Valid time: 0.52007s. GPU RAM: 0.36/10.76 GB
[2023-06-17 21:27:25] INFO Training: Epoch=  6 [train_loss_0=0.2598 is_clicked logloss=0.5779 accuracy=0.7243 f1=0.5989 precision=0.6336 recall=0.5681 auc=0.7679 train_loss_0=0.2641 is_installed logloss=0.4063 accuracy=0.8089 f1=0.2742 precision=0.4757 recall=0.1928 auc=0.7917 train_loss_0=0.2554]
[2023-06-17 21:27:25] INFO Train time: 188.70968s. Valid time: 0.39105s. GPU RAM: 0.36/10.76 GB
[2023-06-17 21:30:31] INFO Training: Epoch=  7 [train_loss_0=0.2595 is_clicked logloss=0.5912 accuracy=0.7312 f1=0.6022 precision=0.6495 recall=0.5614 auc=0.7657 train_loss_0=0.2639 is_installed logloss=0.4023 accuracy=0.8149 f1=0.2407 precision=0.5207 recall=0.1566 auc=0.7936 train_loss_0=0.2552]
[2023-06-17 21:30:31] INFO Train time: 185.33737s. Valid time: 0.40260s. GPU RAM: 0.36/10.76 GB
[2023-06-17 21:33:42] INFO Training: Epoch=  8 [train_loss_0=0.2593 is_clicked logloss=0.5475 accuracy=0.7326 f1=0.6035 precision=0.6524 recall=0.5616 auc=0.7802 train_loss_0=0.2636 is_installed logloss=0.3979 accuracy=0.8131 f1=0.2871 precision=0.5037 recall=0.2010 auc=0.7944 train_loss_0=0.2549]
[2023-06-17 21:33:42] INFO Train time: 190.13923s. Valid time: 0.42098s. GPU RAM: 0.36/10.76 GB
[2023-06-17 21:36:54] INFO Training: Epoch=  9 [train_loss_0=0.2592 is_clicked logloss=0.5448 accuracy=0.7682 f1=0.6355 precision=0.7388 recall=0.5577 auc=0.7839 train_loss_0=0.2635 is_installed logloss=0.3933 accuracy=0.8176 f1=0.2644 precision=0.5417 recall=0.1751 auc=0.8045 train_loss_0=0.2548]
[2023-06-17 21:36:54] INFO Train time: 191.27149s. Valid time: 0.41349s. GPU RAM: 0.36/10.76 GB
[2023-06-17 21:36:54] INFO logloss improved. Best value: 0.3933
[2023-06-17 21:40:01] INFO Training: Epoch= 10 [train_loss_0=0.2590 is_clicked logloss=0.5143 accuracy=0.7679 f1=0.6312 precision=0.7444 recall=0.5480 auc=0.7851 train_loss_0=0.2634 is_installed logloss=0.3948 accuracy=0.8160 f1=0.2929 precision=0.5238 recall=0.2034 auc=0.7987 train_loss_0=0.2547]
[2023-06-17 21:40:01] INFO Train time: 185.93153s. Valid time: 0.47049s. GPU RAM: 0.36/10.76 GB
[2023-06-17 21:43:08] INFO Training: Epoch= 11 [train_loss_0=0.2589 is_clicked logloss=0.5812 accuracy=0.7269 f1=0.5980 precision=0.6411 recall=0.5605 auc=0.7715 train_loss_0=0.2632 is_installed logloss=0.3983 accuracy=0.8130 f1=0.2902 precision=0.5028 recall=0.2041 auc=0.7948 train_loss_0=0.2545]
[2023-06-17 21:43:08] INFO Train time: 186.41813s. Valid time: 0.40002s. GPU RAM: 0.36/10.76 GB
[2023-06-17 21:46:06] INFO Training: Epoch= 12 [train_loss_0=0.2588 is_clicked logloss=0.4970 accuracy=0.7809 f1=0.6475 precision=0.7765 recall=0.5554 auc=0.7903 train_loss_0=0.2631 is_installed logloss=0.3871 accuracy=0.8197 f1=0.3233 precision=0.5455 recall=0.2298 auc=0.8040 train_loss_0=0.2544]
[2023-06-17 21:46:06] INFO Train time: 177.77959s. Valid time: 0.39967s. GPU RAM: 0.36/10.76 GB
[2023-06-17 21:46:07] INFO logloss improved. Best value: 0.3871
[2023-06-17 21:49:16] INFO Training: Epoch= 13 [train_loss_0=0.2586 is_clicked logloss=0.5141 accuracy=0.7628 f1=0.6312 precision=0.7229 recall=0.5602 auc=0.7924 train_loss_0=0.2630 is_installed logloss=0.3947 accuracy=0.8113 f1=0.3548 precision=0.4939 recall=0.2770 auc=0.8008 train_loss_0=0.2543]
[2023-06-17 21:49:16] INFO Train time: 188.14508s. Valid time: 0.52765s. GPU RAM: 0.36/10.76 GB
[2023-06-17 21:52:30] INFO Training: Epoch= 14 [train_loss_0=0.2585 is_clicked logloss=0.5340 accuracy=0.7432 f1=0.6163 precision=0.6722 recall=0.5692 auc=0.7831 train_loss_0=0.2628 is_installed logloss=0.3932 accuracy=0.8130 f1=0.3050 precision=0.5026 recall=0.2191 auc=0.8045 train_loss_0=0.2543]
[2023-06-17 21:52:30] INFO Train time: 193.72982s. Valid time: 0.44294s. GPU RAM: 0.36/10.76 GB
[2023-06-17 21:55:46] INFO Training: Epoch= 15 [train_loss_0=0.2585 is_clicked logloss=0.6138 accuracy=0.7138 f1=0.5925 precision=0.6123 recall=0.5741 auc=0.7685 train_loss_0=0.2628 is_installed logloss=0.4082 accuracy=0.8050 f1=0.2976 precision=0.4580 recall=0.2206 auc=0.7835 train_loss_0=0.2542]
[2023-06-17 21:55:46] INFO Train time: 194.93962s. Valid time: 0.43074s. GPU RAM: 0.36/10.76 GB
[2023-06-17 21:59:01] INFO Training: Epoch= 16 [train_loss_0=0.2584 is_clicked logloss=0.5000 accuracy=0.7721 f1=0.6369 precision=0.7538 recall=0.5514 auc=0.7976 train_loss_0=0.2627 is_installed logloss=0.3978 accuracy=0.8169 f1=0.2555 precision=0.5370 recall=0.1677 auc=0.8122 train_loss_0=0.2542]
[2023-06-17 21:59:01] INFO Train time: 195.11608s. Valid time: 0.43154s. GPU RAM: 0.36/10.76 GB
[2023-06-17 22:02:21] INFO Training: Epoch= 17 [train_loss_0=0.2585 is_clicked logloss=0.4778 accuracy=0.7912 f1=0.6509 precision=0.8262 recall=0.5370 auc=0.8163 train_loss_0=0.2628 is_installed logloss=0.3791 accuracy=0.8245 f1=0.2629 precision=0.6178 recall=0.1671 auc=0.8231 train_loss_0=0.2541]
[2023-06-17 22:02:21] INFO Train time: 198.75201s. Valid time: 0.43877s. GPU RAM: 0.36/10.76 GB
[2023-06-17 22:02:21] INFO logloss improved. Best value: 0.3791
[2023-06-17 22:05:37] INFO Training: Epoch= 18 [train_loss_0=0.2584 is_clicked logloss=0.5755 accuracy=0.7332 f1=0.6095 precision=0.6493 recall=0.5744 auc=0.7745 train_loss_0=0.2627 is_installed logloss=0.3974 accuracy=0.8104 f1=0.3321 precision=0.4889 recall=0.2516 auc=0.7962 train_loss_0=0.2541]
[2023-06-17 22:05:37] INFO Train time: 194.81930s. Valid time: 0.49100s. GPU RAM: 0.36/10.76 GB
[2023-06-17 22:08:54] INFO Training: Epoch= 19 [train_loss_0=0.2584 is_clicked logloss=0.4981 accuracy=0.7839 f1=0.6478 precision=0.7915 recall=0.5484 auc=0.7978 train_loss_0=0.2627 is_installed logloss=0.3932 accuracy=0.8220 f1=0.2888 precision=0.5756 recall=0.1928 auc=0.8111 train_loss_0=0.2541]
[2023-06-17 22:08:54] INFO Train time: 196.15160s. Valid time: 0.44230s. GPU RAM: 0.36/10.76 GB
[2023-06-17 22:12:10] INFO Training: Epoch= 20 [train_loss_0=0.2583 is_clicked logloss=0.5210 accuracy=0.7604 f1=0.6256 precision=0.7212 recall=0.5525 auc=0.7849 train_loss_0=0.2626 is_installed logloss=0.4014 accuracy=0.8140 f1=0.2935 precision=0.5096 recall=0.2062 auc=0.8022 train_loss_0=0.2540]
[2023-06-17 22:12:10] INFO Train time: 196.09145s. Valid time: 0.45756s. GPU RAM: 0.36/10.76 GB
[2023-06-17 22:15:28] INFO Training: Epoch= 21 [train_loss_0=0.2583 is_clicked logloss=0.5132 accuracy=0.7564 f1=0.6238 precision=0.7085 recall=0.5574 auc=0.7873 train_loss_0=0.2626 is_installed logloss=0.3928 accuracy=0.8197 f1=0.2359 precision=0.5742 recall=0.1485 auc=0.8054 train_loss_0=0.2540]
[2023-06-17 22:15:28] INFO Train time: 197.54831s. Valid time: 0.43826s. GPU RAM: 0.36/10.76 GB
[2023-06-17 22:18:47] INFO Training: Epoch= 22 [train_loss_0=0.2583 is_clicked logloss=0.4949 accuracy=0.7834 f1=0.6463 precision=0.7915 recall=0.5462 auc=0.8006 train_loss_0=0.2626 is_installed logloss=0.3935 accuracy=0.8191 f1=0.2968 precision=0.5463 recall=0.2038 auc=0.8079 train_loss_0=0.2540]
[2023-06-17 22:18:47] INFO Train time: 197.91233s. Valid time: 0.44884s. GPU RAM: 0.36/10.76 GB
[2023-06-17 22:22:06] INFO Training: Epoch= 23 [train_loss_0=0.2583 is_clicked logloss=0.4797 accuracy=0.7873 f1=0.6525 precision=0.7999 recall=0.5511 auc=0.8080 train_loss_0=0.2625 is_installed logloss=0.3926 accuracy=0.8165 f1=0.3150 precision=0.5245 recall=0.2252 auc=0.8016 train_loss_0=0.2540]
[2023-06-17 22:22:06] INFO Train time: 198.26097s. Valid time: 0.42571s. GPU RAM: 0.36/10.76 GB
[2023-06-17 22:25:27] INFO Training: Epoch= 24 [train_loss_0=0.2582 is_clicked logloss=0.4894 accuracy=0.7903 f1=0.6525 precision=0.8166 recall=0.5434 auc=0.8023 train_loss_0=0.2625 is_installed logloss=0.3842 accuracy=0.8211 f1=0.2966 precision=0.5643 recall=0.2012 auc=0.8163 train_loss_0=0.2540]
[2023-06-17 22:25:27] INFO Train time: 200.69008s. Valid time: 0.53079s. GPU RAM: 0.36/10.76 GB
[2023-06-17 22:28:44] INFO Training: Epoch= 25 [train_loss_0=0.2582 is_clicked logloss=0.4812 accuracy=0.7928 f1=0.6574 precision=0.8200 recall=0.5487 auc=0.8063 train_loss_0=0.2625 is_installed logloss=0.3946 accuracy=0.8203 f1=0.2663 precision=0.5678 recall=0.1741 auc=0.8101 train_loss_0=0.2539]
[2023-06-17 22:28:44] INFO Train time: 196.12753s. Valid time: 0.42713s. GPU RAM: 0.36/10.76 GB
[2023-06-17 22:31:58] INFO Training: Epoch= 26 [train_loss_0=0.2582 is_clicked logloss=0.5029 accuracy=0.7753 f1=0.6422 precision=0.7593 recall=0.5566 auc=0.7929 train_loss_0=0.2624 is_installed logloss=0.4001 accuracy=0.8168 f1=0.2760 precision=0.5322 recall=0.1865 auc=0.7946 train_loss_0=0.2539]
[2023-06-17 22:31:58] INFO Train time: 193.85644s. Valid time: 0.40064s. GPU RAM: 0.36/10.76 GB
[2023-06-17 22:35:13] INFO Training: Epoch= 27 [train_loss_0=0.2581 is_clicked logloss=0.5671 accuracy=0.7250 f1=0.5961 precision=0.6374 recall=0.5600 auc=0.7752 train_loss_0=0.2624 is_installed logloss=0.4050 accuracy=0.8104 f1=0.2572 precision=0.4844 recall=0.1752 auc=0.7903 train_loss_0=0.2539]
[2023-06-17 22:35:13] INFO Train time: 194.35061s. Valid time: 0.44123s. GPU RAM: 0.36/10.76 GB
[2023-06-17 22:35:13] INFO Early stopped. Since the metric logloss haven't been improved for 10 epochs.
[2023-06-17 22:35:13] INFO The best score of logloss is 0.3791 on epoch 17
[2023-06-17 22:35:13] INFO Best model checkpoint saved in ./saved/MMoE/recsys/2023-06-17-21-05-34.ckpt.
[2023-06-17 22:35:32] INFO Predictions saved in ./predictions/MMoE/2023-06-17-22-35-13['is_clicked', 'is_installed'].csv
